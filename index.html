<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stemmeanalyse</title>
  <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet" />
  <link rel="icon" type="image/png" href="favicon.png" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg:        #f5f4f0;
      --surface:   #ffffff;
      --border:    #e0ddd6;
      --text:      #1a1814;
      --muted:     #7a776e;
      --accent:    #c0392b;
      --accent2:   #1a4a7a;
      --cell-min:  #eef4fb;
      --cell-max:  #1a4a7a;
      --highlight: rgba(192,57,43,0.12);
      --radius:    6px;
      --shadow:    0 2px 16px rgba(0,0,0,0.07);
    }

    html { scroll-behavior: smooth; }

    body {
      font-family: 'DM Sans', sans-serif;
      font-weight: 400;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
    }

    /* ── NAV ── */
    nav {
      position: sticky; top: 0; z-index: 100;
      background: rgba(245,244,240,0.92);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
      padding: 0 2rem;
      display: flex; align-items: center; gap: 2.5rem;
      height: 56px;
    }
    .nav-brand {
      font-family: 'DM Serif Display', serif;
      font-size: 1.1rem;
      color: var(--text);
      text-decoration: none;
      white-space: nowrap;
    }
    .nav-brand span { color: var(--accent); }
    .nav-links { display: flex; gap: 2rem; list-style: none; margin-left: auto; }
    .nav-links a {
      font-size: 0.82rem; font-weight: 500; letter-spacing: 0.05em;
      text-transform: uppercase; color: var(--muted); text-decoration: none;
      transition: color .2s;
    }
    .nav-links a:hover { color: var(--text); }

    /* ── HERO ── */
    header {
      padding: 5rem 2rem 3.5rem;
      max-width: 860px; margin: 0 auto;
    }
    header p.eyebrow {
      font-size: 0.75rem; font-weight: 600; letter-spacing: 0.12em;
      text-transform: uppercase; color: var(--accent);
      margin-bottom: 1rem;
    }
    header h1 {
      font-family: 'DM Serif Display', serif;
      font-size: clamp(2.2rem, 5vw, 3.6rem);
      line-height: 1.12;
      color: var(--text);
      margin-bottom: 1.25rem;
    }
    header h1 em { font-style: italic; color: var(--accent2); }
    header p.lead {
      font-size: 1.05rem; font-weight: 300; color: var(--muted);
      max-width: 560px; line-height: 1.7;
    }
    .stat-row {
      display: flex; gap: 2.5rem; margin-top: 2.5rem;
      flex-wrap: wrap;
    }
    .stat { display: flex; flex-direction: column; gap: 2px; }
    .stat-num {
      font-family: 'DM Serif Display', serif;
      font-size: 2rem; color: var(--text);
    }
    .stat-label { font-size: 0.78rem; color: var(--muted); font-weight: 500; letter-spacing: 0.04em; }

    /* ── SECTIONS ── */
    .section { padding: 4rem 2rem; }
    .section + .section { border-top: 1px solid var(--border); }
    .section-inner { max-width: 1100px; margin: 0 auto; }
    .section-header { margin-bottom: 2.5rem; }
    .section-number {
      font-size: 0.7rem; font-weight: 700; letter-spacing: 0.14em;
      text-transform: uppercase; color: var(--accent);
      display: block; margin-bottom: 0.5rem;
    }
    .section-header h2 {
      font-family: 'DM Serif Display', serif;
      font-size: clamp(1.6rem, 3vw, 2.2rem);
      line-height: 1.2; margin-bottom: 0.6rem;
    }
    .section-header p { font-size: 0.92rem; color: var(--muted); max-width: 500px; line-height: 1.65; }

    /* ── CARD ── */
    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
    }

    /* ── AGREEMENT MATRIX ── */
    .matrix-wrap { overflow-x: auto; padding: 1.5rem; }
    .matrix-legend {
      display: flex; align-items: center; gap: 0.75rem;
      font-size: 0.78rem; color: var(--muted);
      margin-bottom: 1.25rem; justify-content: flex-end;
    }
    .legend-bar {
      width: 120px; height: 10px; border-radius: 3px;
      background: linear-gradient(to right, var(--cell-min), var(--cell-max));
      border: 1px solid var(--border);
    }
    table.matrix {
      border-collapse: separate; border-spacing: 2px;
      font-size: 0.78rem;
    }
    .matrix th {
      font-weight: 600; letter-spacing: 0.02em;
      padding: 4px 6px;
      white-space: nowrap;
    }
    .matrix th.row-label { text-align: right; padding-right: 10px; color: var(--text); }
    .matrix th.col-label {
      text-align: center; writing-mode: vertical-rl;
      transform: rotate(180deg); height: 88px;
      vertical-align: bottom; color: var(--text);
    }
    .matrix td {
      width: 36px; height: 36px;
      text-align: center; vertical-align: middle;
      border-radius: 3px;
      font-size: 0.72rem; font-weight: 500;
      cursor: default;
      transition: transform .15s, box-shadow .15s;
      position: relative;
    }
    .matrix td:hover { transform: scale(1.15); box-shadow: 0 2px 8px rgba(0,0,0,0.18); z-index: 2; }
    .matrix td.diagonal { opacity: 0.35; }
    .matrix tr.highlighted td,
    .matrix td.highlighted { background-color: var(--highlight) !important; color: #1a1814 !important; }

    /* ── SPECTRUM ── */
    .spectrum-card { padding: 2.5rem; }
    .spectrum-track {
      position: relative;
      height: 4px; background: var(--border);
      border-radius: 2px; margin: 4rem 1.5rem 5rem;
    }
    .spectrum-track::before {
      content: 'Venstre'; position: absolute; left: 0; top: -22px;
      font-size: 0.7rem; font-weight: 600; letter-spacing: 0.08em;
      text-transform: uppercase; color: var(--accent);
    }
    .spectrum-track::after {
      content: 'Højre'; position: absolute; right: 0; top: -22px;
      font-size: 0.7rem; font-weight: 600; letter-spacing: 0.08em;
      text-transform: uppercase; color: var(--accent2);
    }
    .spectrum-node {
      position: absolute; top: 50%;
      transform: translate(-50%, -50%);
      display: flex; flex-direction: column; align-items: center;
      cursor: pointer;
    }
    .spectrum-dot {
      width: 14px; height: 14px; border-radius: 50%;
      background: var(--accent2); border: 2px solid white;
      box-shadow: 0 1px 6px rgba(0,0,0,0.2);
      transition: transform .2s;
    }
    .spectrum-node:hover .spectrum-dot { transform: scale(1.4); }
    .spectrum-label {
      position: absolute; top: 18px;
      font-size: 0.72rem; font-weight: 600;
      white-space: nowrap; color: var(--text);
      letter-spacing: 0.03em;
    }
    .spectrum-node:nth-child(odd) .spectrum-label { top: auto; bottom: 18px; }
    .spectrum-sublabel {
      position: absolute; top: 32px;
      font-size: 0.62rem; color: var(--muted);
      white-space: nowrap;
    }
    .spectrum-node:nth-child(odd) .spectrum-sublabel { top: auto; bottom: 32px; }

    /* ── POWER FACTOR ── */
    .power-grid {
      display: grid; gap: 1px;
      background: var(--border);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
    }
    .power-row {
      display: grid; grid-template-columns: 140px 1fr 80px;
      align-items: center; gap: 1.5rem;
      background: var(--surface);
      padding: 0.75rem 1.25rem;
      transition: background .15s;
    }
    .power-row:hover { background: #fafaf7; }
    .power-party {
      font-size: 0.82rem; font-weight: 600; color: var(--text);
      display: flex; flex-direction: column; gap: 2px;
      word-break: break-word;
    }
    .power-party span { font-weight: 400; color: var(--muted); font-size: 0.72rem; }
    .power-bar-wrap {
      position: relative; height: 22px;
      background: var(--bg); border-radius: 3px; overflow: hidden;
    }
    .power-bar {
      height: 100%;
      border-radius: 3px;
      transition: width 1s cubic-bezier(0.23,1,0.32,1);
      display: flex; align-items: center;
      padding-left: 8px;
    }
    .power-center-line {
      position: absolute; left: 50%; top: 0; bottom: 0;
      width: 1px; background: var(--border);
    }
    .power-value {
      font-family: 'DM Serif Display', serif;
      font-size: 1rem; color: var(--text);
      text-align: right;
    }
    .power-header {
      display: grid; grid-template-columns: 140px 1fr 80px;
      gap: 1.5rem; padding: 0.5rem 1.25rem;
      font-size: 0.68rem; font-weight: 700; letter-spacing: 0.08em;
      text-transform: uppercase; color: var(--muted);
      border-bottom: 1px solid var(--border);
    }

    /* ── TOOLTIP ── */
    .tooltip {
      position: fixed; z-index: 999;
      background: var(--text); color: white;
      padding: 5px 10px; border-radius: 4px;
      font-size: 0.75rem; font-weight: 500;
      pointer-events: none; opacity: 0;
      transition: opacity .15s;
    }

    /* ── FOOTER ── */
    footer {
      padding: 2.5rem 2rem;
      border-top: 1px solid var(--border);
      font-size: 0.78rem; color: var(--muted);
      max-width: 1100px; margin: 0 auto;
      display: flex; justify-content: space-between; align-items: center;
      flex-wrap: wrap; gap: 0.5rem;
    }

    @media (max-width: 800px) {
      nav .nav-links { display: none; }
      .power-row, .power-header { grid-template-columns: 100px 1fr 55px; gap: 0.75rem; }

      /* Spectrum: vertical list instead of cramped track */
      .spectrum-track {
        height: auto; background: none;
        display: flex; flex-direction: column; gap: 0.6rem;
        margin: 1rem 0;
      }
      .spectrum-track::before, .spectrum-track::after {
        position: static; writing-mode: horizontal-tb;
        font-size: 0.7rem; margin-bottom: 0.25rem;
      }
      .spectrum-track::before { content: '← Venstre'; }
      .spectrum-track::after  { content: 'Højre →'; }
      .spectrum-node {
        position: static; transform: none;
        flex-direction: row; align-items: center; gap: 0.6rem;
      }
      .spectrum-node:nth-child(odd) .spectrum-label,
      .spectrum-label { position: static; font-size: 0.8rem; }
      .spectrum-node:nth-child(odd) .spectrum-sublabel,
      .spectrum-sublabel { display: none; }
      .spectrum-dot { flex-shrink: 0; }
    }
  </style>
</head>
<body>

<div class="tooltip" id="tooltip"></div>

<nav>
  <a class="nav-brand" href="#"><span>FT</span> Stemmeanalyse</a>
  <ul class="nav-links">
    <li><a href="#matrix">Enighed</a></li>
    <li><a href="#spectrum">Spektrum</a></li>
    <li><a href="#power">Magt</a></li>
    <li><a href="#data">Data</a></li>
  </ul>
</nav>

<header>
  <p class="eyebrow">Folketing · 2014 – 2026</p>
  <h1>Hvem stemmer<br>med <em>hvem?</em></h1>
  <p class="lead">Den 24. marts 2026 er der folketingsvalg i Danmark. Dette er en dataanalyse af mere end 7.000 afstemninger i Folketinget i perioden 2014-2026. Se hvordan partierne stemmer i forhold til hinanden, hvor de befinder sig på det politiske spektrum, og om de er et magt- eller protestparti.</p>
  <div class="stat-row">
    <div class="stat"><span class="stat-num">7.564</span><span class="stat-label">Afstemninger</span></div>
    <div class="stat"><span class="stat-num">12</span><span class="stat-label">Partier</span></div>
    <div class="stat"><span class="stat-num">2014–26</span><span class="stat-label">Periode</span></div>
  </div>
</header>

<!-- ── SECTION 1: MATRIX ── -->
<section class="section" id="matrix">
  <div class="section-inner">
    <div class="section-header">
      <span class="section-number">01 — Enighed</span>
      <h2>Afstemningsmatrix</h2>
      <p>Andelen af afstemninger hvor to partier stemte det samme. Klik på et parti for at fremhæve det.</p>
    </div>
    <div class="card">
      <div class="matrix-wrap">
        <div class="matrix-legend">
          <span>Lav enighed</span>
          <div class="legend-bar"></div>
          <span>Høj enighed</span>
        </div>
        <table class="matrix" id="agreementMatrix"></table>
      </div>
    </div>
  </div>
</section>

<!-- ── SECTION 2: SPECTRUM ── -->
<section class="section" id="spectrum">
  <div class="section-inner">
    <div class="section-header">
      <span class="section-number">02 — Spektrum</span>
      <h2>Det politiske spektrum</h2>
      <p>Ud fra tabellen ovenfor kan vi beregne partiernes rækkefølge på det politiske spektrum.</p>
    </div>
    <div class="card spectrum-card">
      <div class="spectrum-track" id="spectrumTrack"></div>
    </div>
  </div>
</section>

<!-- ── SECTION 3: POWER ── -->
<section class="section" id="power">
  <div class="section-inner">
    <div class="section-header">
      <span class="section-number">03 — Magt</span>
      <h2>Magt- eller protestparti</h2>
      <p>Hvor tit er et parti på den vindende side af en afstemning?</p>
    </div>
    <div class="card" id="powerChart"></div>
  </div>
</section>

<!-- ── SECTION 3: DATA ── -->
<section class="section" id="data">
  <div class="section-inner">
    <div class="section-header">
      <span class="section-number">04 — Om data</span>
      <h2>Yderligere oplysninger</h2>
      <p>Denne hjemmeside er baseret på åbne data fra folketinget, og skal forstås som en indikator fremfor en entydig sandhed. Kun data om de partier der stiller op til valget 2026 er taget med. På grund af uperfektheder i data er en række afstemninger blevet ignoreret. Eksempelvis er data for to længere perioder blevet fejlformateret, og disse perioder er derfor ignoreret. </p>
      <p>Rækkefølgen af partier i afstemningsmatricen og langs det politiske spektrum er beregnet som den rækkefølge der gør afstemningsmatricen mest diagonal. Dermed grupperes enige partier sammen, og uenige partier flyttes væk fra hinanden.</p>
      <p>Data og beregninger kan findes på <a href="https://github.com/AndBM/stemmeanalyse">GitHub</a>. Siden er designet og opsat af Claude.ai, Sonnet 4.6.</p>
      <p>Forfatteren kan kontaktes via <a href="https://abmichelsen.com">abmichelsen.dk</a></p>
    </div>
  </div>
</section>

<footer>
  <span>Folketinget hverken godkender, støtter, anbefaler eller markedsfører denne hjemmeside.</span>
  <span>Opdateret 2026-02-27 · Kilde: <a href="https://oda.ft.dk/">oda.ft.dk</a></span>
</footer>

<script>
// ── DATA PLACEHOLDERS ──
// Replace these with your actual data

const PARTIES = [
{ short: 'EL',  name: 'Enhedslisten',             color: '#922b21' },  
{ short: 'ALT', name: 'Alternativet',             color: '#1d8348' },
{ short: 'SF',  name: 'Socialistisk Folkeparti',                       color: '#e67e22' },
{ short: 'RV',  name: 'Radikale Venstre',         color: '#cb4335' },
{ short: 'S',   name: 'Socialdemokratiet',       color: '#c0392b' },
{ short: 'M',   name: 'Moderaterne',              color: '#8e44ad' },
  { short: 'V',   name: 'Venstre',                  color: '#1a4a7a' },
  { short: 'KF',  name: 'Det Konservative Folkeparti',         color: '#196f3d' },
  { short: 'LA',  name: 'Liberal Alliance',         color: '#17a589' },
  { short: 'DD',  name: 'Danmarksdemokraterne',     color: '#2e86c1' },
  { short: 'DF',  name: 'Dansk Folkeparti',         color: '#f4d03f' },
  { short: 'BP',  name: 'Borgernes Parti',           color: '#117a65' },
];

// Agreement matrix (12×12), values 0–1
// REPLACE with real values — fill with random plausible data for now
//const AGREEMENT = PARTIES.map((p, i) => PARTIES.map((q, j) => {
  //if (i === j) return 1;
  // Placeholder: ideological distance → similarity (replace with real data)
  //const SPECTRUM_POS = [0.15, 0.72, 0.22, 0.55, 0.05, 0.80, 0.88, 0.78, 0.30, 0.82, 0.92, 0.10];
  //return Math.max(0, 1 - Math.abs(SPECTRUM_POS[i] - SPECTRUM_POS[j]) * 1.4 + (Math.random() - 0.5) * 0.08);
//}));

const AGREEMENT = [
  [1.0000, 0.8437, 0.7962, 0.7095, 0.6217, 0.6017, 0.4542, 0.4353, 0.4344, 0.4878, 0.4146, 0.3625],
  [0.8437, 1.0000, 0.8200, 0.7671, 0.6289, 0.6017, 0.5241, 0.5000, 0.5045, 0.5185, 0.4377, 0.3474],
  [0.7962, 0.8200, 1.0000, 0.8495, 0.7936, 0.7349, 0.6161, 0.5840, 0.5419, 0.5429, 0.4905, 0.3595],
  [0.7095, 0.7671, 0.8495, 1.0000, 0.8460, 0.7980, 0.7009, 0.6683, 0.6213, 0.5636, 0.5276, 0.3686],
  [0.6217, 0.6289, 0.7936, 0.8460, 1.0000, 0.9943, 0.7912, 0.7222, 0.6678, 0.6024, 0.5781, 0.4018],
  [0.6017, 0.6017, 0.7349, 0.7980, 0.9943, 1.0000, 0.9930, 0.7304, 0.7304, 0.6087, 0.5347, 0.4048],
  [0.4542, 0.5241, 0.6161, 0.7009, 0.7912, 0.9930, 1.0000, 0.8947, 0.7978, 0.6124, 0.7209, 0.4109],
  [0.4353, 0.5000, 0.5840, 0.6683, 0.7222, 0.7304, 0.8947, 1.0000, 0.8083, 0.7721, 0.7362, 0.5710],
  [0.4344, 0.5045, 0.5419, 0.6213, 0.6678, 0.7304, 0.7978, 0.8083, 1.0000, 0.7232, 0.6932, 0.6375],
  [0.4878, 0.5185, 0.5429, 0.5636, 0.6024, 0.6087, 0.6124, 0.7721, 0.7232, 1.0000, 0.7351, 0.7009],
  [0.4146, 0.4377, 0.4905, 0.5276, 0.5781, 0.5347, 0.7209, 0.7362, 0.6932, 0.7351, 1.0000, 0.7402],
  [0.3625, 0.3474, 0.3595, 0.3686, 0.4018, 0.4048, 0.4109, 0.5710, 0.6375, 0.7009, 0.7402, 1.0000],
];

// Spectrum positions 0 (left) → 1 (right)
// REPLACE with MDS/PCA result from your real data
const SPECTRUM_POS = {
  'EL': 0.1 ,
  'ALT': 0.17272727, 
  'SF': 0.245, 
  'RV': 0.31818182,
  'S':   0.390, 
  'M':  0.463, 
  'V': 0.536, 
  'KF': 0.6090,
  'LA':  0.681818, 
  'DD': 0.7545, 
  'DF': 0.8272, 
  'BP': 0.9
};

//  'EL': 0.009241334231669318, 
//  'ALT': 0.0322159627726748, 
//  'SF': 0.06963506955209904, 
//  'RV': 0.16133166017875647,
//  'S':   0.30057557644011834, 
//  'M':  0.3445744081831493, 
//  'V': 0.567236280174442, 
//  'KF': 0.7153525098873476,
//  'LA':  0.746239377254285, 
//  'DD': 0.7858805684747309, 
//  'DF': 0.8845125089719496, 
//  'BP': 0.9803429199199594

// Power factor: { agree_with_majority, oppose_minority } → single score 0–1
// REPLACE with real computed values
const POWER = [
  { short: 'M',   score: 0.99, label: '99%' },
  { short: 'S',   score: 0.93, label: '93%' },
  { short: 'V',  score: 0.88, label: '88%' },
  { short: 'RV',   score: 0.82, label: '82%' },
  { short: 'KF',  score: 0.82, label: '82%' },
  { short: 'LA',  score: 0.75, label: '75%' },
  { short: 'SF',  score: 0.75, label: '75%' },
  { short: 'DF',  score: 0.68, label: '68%' },
  { short: 'DD',  score: 0.64, label: '64%' },
  { short: 'ALT',  score: 0.61, label: '61%' },
  { short: 'EL',  score: 0.58, label: '58%' },
  { short: 'BP', score: 0.46, label: '46%' },
].sort((a, b) => b.score - a.score);


// ── HELPERS ──
function lerp(a, b, t) { return a + (b - a) * t; }
function hexToRgb(hex) {
  const r = parseInt(hex.slice(1,3),16);
  const g = parseInt(hex.slice(3,5),16);
  const b = parseInt(hex.slice(5,7),16);
  return [r,g,b];
}
function blendColor(t) {
  // low: #eef4fb  high: #1a4a7a
  const lo = [238,244,251], hi = [26,74,122];
  const r = Math.round(lerp(lo[0],hi[0],t));
  const g = Math.round(lerp(lo[1],hi[1],t));
  const b = Math.round(lerp(lo[2],hi[2],t));
  const textBright = t > 0.5 ? '#fff' : '#1a1814';
  return { bg: `rgb(${r},${g},${b})`, fg: textBright };
}

// ── MATRIX ──
(function buildMatrix() {
  const table = document.getElementById('agreementMatrix');
  const N = PARTIES.length;

  // Header row
  const thead = document.createElement('thead');
  const headerRow = document.createElement('tr');
  headerRow.appendChild(document.createElement('th')); // corner
  PARTIES.forEach(p => {
    const th = document.createElement('th');
    th.className = 'col-label';
    th.textContent = p.short;
    th.dataset.idx = PARTIES.indexOf(p);
    th.title = p.name;
    th.style.cursor = 'pointer';
    th.addEventListener('click', () => toggleHighlight(PARTIES.indexOf(p)));
    headerRow.appendChild(th);
  });
  thead.appendChild(headerRow);
  table.appendChild(thead);

  // Body
  const tbody = document.createElement('tbody');
  PARTIES.forEach((p, i) => {
    const tr = document.createElement('tr');
    tr.dataset.idx = i;
    // Row label
    const th = document.createElement('th');
    th.className = 'row-label';
    th.textContent = p.short;
    th.title = p.name;
    th.style.cursor = 'pointer';
    th.addEventListener('click', () => toggleHighlight(i));
    tr.appendChild(th);
    // Cells
    PARTIES.forEach((q, j) => {
      const td = document.createElement('td');
      const v = Math.min(1, Math.max(0, AGREEMENT[i][j]));
      const { bg, fg } = blendColor(i === j ? 0 : v);
      td.style.background = bg;
      td.style.color = fg;
      if (i === j) { td.className = 'diagonal'; td.textContent = '—'; }
      else { td.textContent = Math.round(v * 100) + '%'; }
      td.dataset.row = i; td.dataset.col = j;
      td.dataset.value = v.toFixed(3);
      // Tooltip
      td.addEventListener('mouseenter', e => showTip(e, `${p.short} & ${q.short}: ${Math.round(v*100)}% enige`));
      td.addEventListener('mouseleave', hideTip);
      tr.appendChild(td);
    });
    tbody.appendChild(tr);
  });
  table.appendChild(tbody);

  let activeIdx = null;
  function toggleHighlight(idx) {
    if (activeIdx === idx) {
      // deselect
      table.querySelectorAll('tr, td').forEach(el => el.classList.remove('highlighted'));
      activeIdx = null;
    } else {
      table.querySelectorAll('tr, td').forEach(el => el.classList.remove('highlighted'));
      // highlight row
      tbody.querySelectorAll(`tr[data-idx="${idx}"]`)[0]?.classList.add('highlighted');
      // highlight col cells
      tbody.querySelectorAll(`td[data-col="${idx}"]`).forEach(td => td.classList.add('highlighted'));
      activeIdx = idx;
    }
  }
})();

// ── SPECTRUM ──
(function buildSpectrum() {
  const track = document.getElementById('spectrumTrack');
  PARTIES.forEach((p, i) => {
    const pos = SPECTRUM_POS[p.short];
    const node = document.createElement('div');
    node.className = 'spectrum-node';
    node.style.left = (pos * 100) + '%';
    node.innerHTML = `
      <div class="spectrum-dot" style="background:${p.color}"></div>
      <div class="spectrum-label">${p.short}</div>
    `;
    node.title = p.name;
    node.addEventListener('mouseenter', e => showTip(e, p.name));
    node.addEventListener('mouseleave', hideTip);
    track.appendChild(node);
  });
})();

// ── POWER CHART ──
(function buildPower() {
  const container = document.getElementById('powerChart');
  const header = document.createElement('div');
  header.className = 'power-header';
  header.innerHTML = '<span>Parti</span><span>Vundne afstemninger</span><span></span>';
  container.appendChild(header);

  const grid = document.createElement('div');
  grid.className = 'power-grid';

  POWER.forEach(item => {
    const party = PARTIES.find(p => p.short === item.short);
    const row = document.createElement('div');
    row.className = 'power-row';

    const pct = Math.round(item.score * 100);
    // Bar goes from center for clarity, or left-to-right — using simple left-to-right
    row.innerHTML = `
      <div class="power-party">${party.name}<span>${party.short}</span></div>
      <div class="power-bar-wrap">
        <div class="power-bar" style="width:0%;background:${party.color}22;border-right:3px solid ${party.color}" data-target="${item.score * 100}"></div>
      </div>
      <div class="power-value">${item.label}</div>
    `;
    grid.appendChild(row);
  });
  container.appendChild(grid);

  // Animate bars on scroll
  const bars = grid.querySelectorAll('.power-bar');
  const observer = new IntersectionObserver(entries => {
    if (entries[0].isIntersecting) {
      bars.forEach(bar => { bar.style.width = bar.dataset.target + '%'; });
      observer.disconnect();
    }
  }, { threshold: 0.2 });
  observer.observe(grid);
})();

// ── TOOLTIP ──
const tooltipEl = document.getElementById('tooltip');
function showTip(e, text) {
  tooltipEl.textContent = text;
  tooltipEl.style.opacity = '1';
  moveTip(e);
}
function moveTip(e) {
  tooltipEl.style.left = (e.clientX + 14) + 'px';
  tooltipEl.style.top  = (e.clientY - 28) + 'px';
}
function hideTip() { tooltipEl.style.opacity = '0'; }
document.addEventListener('mousemove', e => { if (tooltipEl.style.opacity === '1') moveTip(e); });
</script>
</body>
</html>
